2025-03-16 02:24:01,274 - root - INFO - LabelQuick 应用程序启动
2025-03-16 02:24:01,537 - hydra.core.utils - DEBUG - Setting JobRuntime:name=UNKNOWN_NAME
2025-03-16 02:24:01,537 - hydra.core.utils - DEBUG - Setting JobRuntime:name=app
2025-03-16 02:24:06,102 - root - INFO - 初始化主界面
2025-03-16 02:24:07,116 - root - DEBUG - UI 设置完成
2025-03-16 02:24:07,116 - root - DEBUG - 初始化变量完成
2025-03-16 02:24:09,444 - root - INFO - Loaded checkpoint sucessfully
2025-03-16 02:24:11,692 - root - INFO - Loaded checkpoint sucessfully
2025-03-16 02:24:11,706 - root - DEBUG - 初始化 Anything_TW 和 AnythingVideo_TW 完成
2025-03-16 02:24:11,706 - root - DEBUG - 初始化定时器完成
2025-03-16 02:24:11,706 - root - DEBUG - 开始连接信号和槽
2025-03-16 02:24:11,707 - root - DEBUG - 信号和槽连接完成
2025-03-16 02:24:11,707 - root - DEBUG - 初始化标签格式: xml
2025-03-16 02:24:11,707 - root - INFO - 主界面初始化完成
2025-03-16 02:24:17,997 - root - INFO - 标签格式已更改: xml -> yolo
2025-03-16 02:24:17,997 - root - DEBUG - 检查 YOLO 格式的类别映射
2025-03-16 02:24:17,997 - root - DEBUG - 类别映射为空，尝试从现有标签初始化
2025-03-16 02:24:17,997 - root - DEBUG - 当前类别映射: {}
2025-03-16 02:24:35,473 - root - INFO - For numpy array image, we assume (HxWxC) format
2025-03-16 02:24:35,704 - root - INFO - Computing image embeddings for the provided image...
2025-03-16 02:24:43,182 - root - INFO - Image embeddings computed.
2025-03-16 02:24:59,614 - root - INFO - 视频对话框确认，标签文本: 篮球
2025-03-16 02:24:59,614 - root - WARNING - 未设置保存路径
2025-03-16 02:25:01,571 - root - DEBUG - 重置点击和绘制事件状态
2025-03-16 02:25:01,571 - root - DEBUG - 开始显示已存在的标签和边界框
2025-03-16 02:25:01,583 - root - DEBUG - 没有标签需要显示，显示原始图像
2025-03-16 02:25:01,584 - root - DEBUG - 显示已存在的标签
2025-03-16 02:25:08,294 - root - INFO - 检查图像 0 的已存在标签
2025-03-16 02:25:08,295 - root - DEBUG - XML 文件存在: False, YOLO 文件存在: True, 当前格式: yolo
2025-03-16 02:25:08,295 - root - DEBUG - 加载 YOLO 标签文件: D:/workspace/LabelQuick/video/0.txt
2025-03-16 02:25:08,295 - root - DEBUG - YOLO 文件包含 2 行
2025-03-16 02:25:08,295 - root - DEBUG - 从 D:/workspace/LabelQuick/video\classes.txt 加载类别映射
2025-03-16 02:25:08,296 - root - DEBUG - 加载的类别映射: {'篮球': 0}
2025-03-16 02:25:08,296 - root - DEBUG - 反向类别映射: {0: '篮球'}
2025-03-16 02:25:08,296 - root - DEBUG - 处理第 1 行: 0 0.435000 0.246603 0.028462 0.042120
2025-03-16 02:25:08,296 - root - DEBUG - YOLO 坐标 (0.435, 0.246603, 0.028462, 0.04212) -> 像素坐标 (546, 165, 37, 31)
2025-03-16 02:25:08,296 - root - DEBUG - 类别 ID 0 映射到名称: 篮球
2025-03-16 02:25:08,296 - root - DEBUG - 添加标签到 UI: 篮球
2025-03-16 02:25:08,296 - root - DEBUG - 处理第 2 行: 0 0.438077 0.252717 0.022308 0.038043
2025-03-16 02:25:08,296 - root - DEBUG - YOLO 坐标 (0.438077, 0.252717, 0.022308, 0.038043) -> 像素坐标 (554, 171, 29, 27)
2025-03-16 02:25:08,296 - root - DEBUG - 类别 ID 0 映射到名称: 篮球
2025-03-16 02:25:08,296 - root - DEBUG - 添加标签到 UI: 篮球
2025-03-16 02:25:08,297 - root - DEBUG - 开始显示已存在的标签和边界框
2025-03-16 02:25:08,308 - root - DEBUG - 显示 0 个点击标签和 2 个绘制标签
2025-03-16 02:25:08,308 - root - DEBUG - 绘制手动标签 1: (546, 165) - (583, 196)
2025-03-16 02:25:08,308 - root - DEBUG - 绘制手动标签 2: (554, 171) - (583, 198)
2025-03-16 02:25:08,309 - root - DEBUG - 标签显示完成
2025-03-16 02:25:08,310 - root - INFO - 已加载 YOLO 格式标签: D:/workspace/LabelQuick/video/0.txt, 共 2 个标签
2025-03-16 02:25:39,546 - root - INFO - For numpy array image, we assume (HxWxC) format
2025-03-16 02:25:39,588 - root - INFO - Computing image embeddings for the provided image...
2025-03-16 02:25:46,589 - root - INFO - Image embeddings computed.
2025-03-16 02:26:01,659 - root - INFO - 视频对话框确认，标签文本: 篮球
2025-03-16 02:26:01,659 - root - DEBUG - 添加标签到列表: 篮球
2025-03-16 02:26:01,659 - root - DEBUG - 使用 YOLO 格式保存标签: 篮球
2025-03-16 02:26:01,659 - root - DEBUG - 边界框坐标: x=560, y=177, w=20, h=22
2025-03-16 02:26:01,660 - util.yolofile - DEBUG - 创建 YOLO 标签信息: 图像=0, 尺寸=1300x736, 文本=篮球
2025-03-16 02:26:01,660 - util.yolofile - DEBUG - 边界框: x=560, y=177, w=20, h=22
2025-03-16 02:26:01,660 - util.yolofile - DEBUG - YOLO 标签文件路径: D:/workspace/LabelQuick/video\0.txt
2025-03-16 02:26:01,660 - util.yolofile - DEBUG - YOLO 标签信息已创建: 路径=D:/workspace/LabelQuick/video\0.txt, 大小=[1300, 736, 3], 边界框=[560, 177, 580, 199]
2025-03-16 02:26:01,660 - root - DEBUG - 保存 YOLO 标签到: D:/workspace/LabelQuick/video\0.txt, 大小: [1300, 736, 3], 类别映射: {'篮球': 0}
2025-03-16 02:26:01,660 - util.yolofile - INFO - 保存 YOLO 格式标签: 图像=D:/workspace/LabelQuick/video\0.jpg, 保存路径=D:/workspace/LabelQuick/video
2025-03-16 02:26:01,661 - util.yolofile - DEBUG - 类别映射: {'篮球': 0}
2025-03-16 02:26:01,661 - util.yolofile - DEBUG - 标签数量: 3
2025-03-16 02:26:01,661 - util.yolofile - DEBUG - 图像名称: 0
2025-03-16 02:26:01,661 - util.yolofile - DEBUG - 标签文件路径: D:/workspace/LabelQuick/video\0.txt
2025-03-16 02:26:01,661 - util.yolofile - DEBUG - 图像尺寸: 1300x736
2025-03-16 02:26:01,661 - util.yolofile - INFO - 类别映射已保存到: D:/workspace/LabelQuick/video\classes.txt
2025-03-16 02:26:01,662 - util.yolofile - DEBUG - 标签 1: 类别=篮球(ID=0), 边界框=(546, 165, 583, 196)
2025-03-16 02:26:01,662 - util.yolofile - DEBUG - 转换坐标到 YOLO 格式: 图像尺寸=(1300, 736), 边界框=(546, 165, 583, 196)
2025-03-16 02:26:01,662 - util.yolofile - DEBUG - YOLO 格式坐标: 中心点=(0.434231, 0.245245), 尺寸=(0.028462, 0.042120)
2025-03-16 02:26:01,662 - util.yolofile - DEBUG - 写入行: 0 0.434231 0.245245 0.028462 0.042120
2025-03-16 02:26:01,662 - util.yolofile - DEBUG - 标签 2: 类别=篮球(ID=0), 边界框=(554, 171, 583, 198)
2025-03-16 02:26:01,662 - util.yolofile - DEBUG - 转换坐标到 YOLO 格式: 图像尺寸=(1300, 736), 边界框=(554, 171, 583, 198)
2025-03-16 02:26:01,662 - util.yolofile - DEBUG - YOLO 格式坐标: 中心点=(0.437308, 0.250679), 尺寸=(0.022308, 0.036685)
2025-03-16 02:26:01,662 - util.yolofile - DEBUG - 写入行: 0 0.437308 0.250679 0.022308 0.036685
2025-03-16 02:26:01,662 - util.yolofile - DEBUG - 标签 3: 类别=篮球(ID=0), 边界框=(560, 177, 580, 199)
2025-03-16 02:26:01,662 - util.yolofile - DEBUG - 转换坐标到 YOLO 格式: 图像尺寸=(1300, 736), 边界框=(560, 177, 580, 199)
2025-03-16 02:26:01,663 - util.yolofile - DEBUG - YOLO 格式坐标: 中心点=(0.438462, 0.255435), 尺寸=(0.015385, 0.029891)
2025-03-16 02:26:01,663 - util.yolofile - DEBUG - 写入行: 0 0.438462 0.255435 0.015385 0.029891
2025-03-16 02:26:01,663 - util.yolofile - INFO - YOLO 标签已保存到: D:/workspace/LabelQuick/video\0.txt
2025-03-16 02:26:01,663 - root - INFO - YOLO 标签已保存: D:/workspace/LabelQuick/video\0.txt
2025-03-16 02:26:01,663 - root - DEBUG - 启用开始检测打标按钮
2025-03-16 02:26:01,663 - root - DEBUG - 重置点击和绘制事件状态
2025-03-16 02:26:01,663 - root - DEBUG - 开始显示已存在的标签和边界框
2025-03-16 02:26:01,675 - root - DEBUG - 显示 1 个点击标签和 2 个绘制标签
2025-03-16 02:26:01,675 - root - DEBUG - 绘制点击标签 1: (560, 177) - (580, 199)
2025-03-16 02:26:01,675 - root - DEBUG - 绘制手动标签 1: (546, 165) - (583, 196)
2025-03-16 02:26:01,675 - root - DEBUG - 绘制手动标签 2: (554, 171) - (583, 198)
2025-03-16 02:26:01,677 - root - DEBUG - 标签显示完成
2025-03-16 02:26:01,678 - root - DEBUG - 显示已存在的标签
2025-03-16 02:26:04,854 - root - INFO - 开始视频检测打标
2025-03-16 02:26:04,855 - root - DEBUG - 禁用开始检测打标按钮
2025-03-16 02:26:04,855 - root - DEBUG - 视频路径: D:/workspace/LabelQuick/video/ceshi.mp4, 输出目录: D:/workspace/LabelQuick/video
2025-03-16 02:26:04,855 - root - DEBUG - 创建视频处理线程，点击坐标: (563, 177), 方法: 1, 文本: 篮球
2025-03-16 02:26:04,855 - root - DEBUG - 保存路径: D:/workspace/LabelQuick/video, 格式: yolo, 类别映射: {'篮球': 0}
2025-03-16 02:26:04,855 - root - INFO - 初始化视频处理线程
2025-03-16 02:26:07,311 - root - INFO - Loaded checkpoint sucessfully
2025-03-16 02:26:07,325 - root - DEBUG - 视频处理线程初始化完成: 视频路径=D:/workspace/LabelQuick/video/ceshi.mp4, 输出目录=D:/workspace/LabelQuick/video, 格式=yolo
2025-03-16 02:26:07,325 - root - DEBUG - 连接视频处理线程信号
2025-03-16 02:26:07,325 - root - INFO - 启动视频处理线程
2025-03-16 02:26:07,326 - root - DEBUG - 禁用其他按钮，防止重复处理
2025-03-16 02:26:07,327 - root - INFO - 开始视频处理: 点击坐标=(563, 177), 方法=1
2025-03-16 02:26:07,327 - root - DEBUG - 创建输出目录: D:/workspace/LabelQuick/video 和 mask 子目录: D:/workspace/LabelQuick/video\mask
2025-03-16 02:26:07,327 - root - INFO - 开始从视频中提取帧
2025-03-16 02:26:08,266 - root - INFO - 视频帧提取完成，设置视频目录: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,266 - sampro.LabelVideo_TW - DEBUG - 找到 18 个帧文件
2025-03-16 02:26:08,267 - sampro.LabelVideo_TW - DEBUG - 使用数字提取排序成功
2025-03-16 02:26:08,268 - sampro.LabelVideo_TW - DEBUG - 排序后的前5个文件: ['0.jpg', '1.jpg', 'image1.jpg', '2.jpg', '3.jpg']
2025-03-16 02:26:08,291 - root - INFO - 开始视频推理
2025-03-16 02:26:08,292 - root - ERROR - 视频推理出错: invalid literal for int() with base 10: 'image1'
2025-03-16 02:26:08,296 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 124, in run
    self.AVT.inference(self.output_dir)
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 93, in inference
    self.inference_state = self.predictor.init_state(video_path=video_dir)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 51, in init_state
    images, video_height, video_width = load_video_frames(
                                        ^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\utils\misc.py", line 198, in load_video_frames
    return load_video_frames_from_jpg_images(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\utils\misc.py", line 248, in load_video_frames_from_jpg_images
    frame_names.sort(key=lambda p: int(os.path.splitext(p)[0]))
  File "D:\workspace\LabelQuick\sampro\sam2\utils\misc.py", line 248, in <lambda>
    frame_names.sort(key=lambda p: int(os.path.splitext(p)[0]))
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: invalid literal for int() with base 10: 'image1'

2025-03-16 02:26:08,297 - root - INFO - 开始处理视频帧，总帧数: 18
2025-03-16 02:26:08,297 - root - DEBUG - 处理第 1/18 帧: D:/workspace/LabelQuick/video\0.jpg
2025-03-16 02:26:08,297 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,297 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,298 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,298 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,298 - root - ERROR - 处理第 1 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,299 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,300 - root - DEBUG - 处理第 2/18 帧: D:/workspace/LabelQuick/video\1.jpg
2025-03-16 02:26:08,300 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,300 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,300 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,300 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,300 - root - ERROR - 处理第 2 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,301 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,302 - root - DEBUG - 处理第 3/18 帧: D:/workspace/LabelQuick/video\image1.jpg
2025-03-16 02:26:08,302 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,302 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,302 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,302 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,303 - root - ERROR - 处理第 3 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,304 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,305 - root - DEBUG - 处理第 4/18 帧: D:/workspace/LabelQuick/video\2.jpg
2025-03-16 02:26:08,305 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,305 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,305 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,306 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,306 - root - ERROR - 处理第 4 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,307 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,308 - root - DEBUG - 处理第 5/18 帧: D:/workspace/LabelQuick/video\3.jpg
2025-03-16 02:26:08,308 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,308 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,309 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,309 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,309 - root - ERROR - 处理第 5 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,310 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,311 - root - DEBUG - 处理第 6/18 帧: D:/workspace/LabelQuick/video\4.jpg
2025-03-16 02:26:08,311 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,311 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,311 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,311 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,311 - root - ERROR - 处理第 6 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,313 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,313 - root - DEBUG - 处理第 7/18 帧: D:/workspace/LabelQuick/video\5.jpg
2025-03-16 02:26:08,313 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,313 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,314 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,314 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,314 - root - ERROR - 处理第 7 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,316 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,316 - root - DEBUG - 处理第 8/18 帧: D:/workspace/LabelQuick/video\6.jpg
2025-03-16 02:26:08,317 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,317 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,317 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,317 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,317 - root - ERROR - 处理第 8 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,319 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,320 - root - DEBUG - 处理第 9/18 帧: D:/workspace/LabelQuick/video\7.jpg
2025-03-16 02:26:08,320 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,320 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,320 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,321 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,321 - root - ERROR - 处理第 9 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,322 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,323 - root - DEBUG - 处理第 10/18 帧: D:/workspace/LabelQuick/video\8.jpg
2025-03-16 02:26:08,323 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,323 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,324 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,324 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,325 - root - ERROR - 处理第 10 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,326 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,327 - root - DEBUG - 处理第 11/18 帧: D:/workspace/LabelQuick/video\9.jpg
2025-03-16 02:26:08,327 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,327 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,327 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,327 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,328 - root - ERROR - 处理第 11 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,329 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,329 - root - DEBUG - 处理第 12/18 帧: D:/workspace/LabelQuick/video\10.jpg
2025-03-16 02:26:08,329 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,329 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,329 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,329 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,330 - root - ERROR - 处理第 12 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,331 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,331 - root - DEBUG - 处理第 13/18 帧: D:/workspace/LabelQuick/video\11.jpg
2025-03-16 02:26:08,331 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,331 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,331 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,331 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,332 - root - ERROR - 处理第 13 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,332 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,333 - root - DEBUG - 处理第 14/18 帧: D:/workspace/LabelQuick/video\12.jpg
2025-03-16 02:26:08,333 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,333 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,333 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,334 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,334 - root - ERROR - 处理第 14 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,335 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,335 - root - DEBUG - 处理第 15/18 帧: D:/workspace/LabelQuick/video\13.jpg
2025-03-16 02:26:08,335 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,335 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,335 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,336 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,336 - root - ERROR - 处理第 15 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,337 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,337 - root - DEBUG - 处理第 16/18 帧: D:/workspace/LabelQuick/video\14.jpg
2025-03-16 02:26:08,338 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,338 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,338 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,338 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,338 - root - ERROR - 处理第 16 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,339 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,340 - root - DEBUG - 处理第 17/18 帧: D:/workspace/LabelQuick/video\15.jpg
2025-03-16 02:26:08,340 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,340 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,340 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,340 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,341 - root - ERROR - 处理第 17 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,341 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,342 - root - DEBUG - 处理第 18/18 帧: D:/workspace/LabelQuick/video\16.jpg
2025-03-16 02:26:08,342 - root - DEBUG - 调用 Draw_Mask_at_frame 处理帧，格式: yolo
2025-03-16 02:26:08,342 - sampro.LabelVideo_TW - INFO - 开始绘制轮廓，格式: yolo, 文本: 篮球
2025-03-16 02:26:08,342 - sampro.LabelVideo_TW - DEBUG - 起始帧: 0, 返回帧: False, 保存图像路径: D:/workspace/LabelQuick/video\mask, 保存标签路径: D:/workspace/LabelQuick/video
2025-03-16 02:26:08,342 - sampro.LabelVideo_TW - DEBUG - 开始在视频中传播分割结果
2025-03-16 02:26:08,342 - root - ERROR - 处理第 18 帧时出错: 'NoneType' object is not subscriptable
2025-03-16 02:26:08,343 - root - ERROR - Traceback (most recent call last):
  File "D:\workspace\LabelQuick\GUI\main.py", line 145, in run
    processed_frame, xml_messages = self.AVT.Draw_Mask_at_frame(
                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\LabelVideo_TW.py", line 398, in Draw_Mask_at_frame
    for out_frame_idx, out_obj_ids, out_mask_logits in self.predictor.propagate_in_video(self.inference_state):
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 36, in generator_context
    response = gen.send(None)
               ^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 554, in propagate_in_video
    self.propagate_in_video_preflight(inference_state)
  File "d:\workspace\LabelQuick\.conda\Lib\site-packages\torch\utils\_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 483, in propagate_in_video_preflight
    batch_size = self._get_obj_num(inference_state)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\workspace\LabelQuick\sampro\sam2\sam2_video_predictor.py", line 158, in _get_obj_num
    return len(inference_state["obj_idx_to_id"])
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

2025-03-16 02:26:08,344 - root - INFO - 视频处理完成，发送完成信号
2025-03-16 02:26:08,344 - root - INFO - 视频处理完成
2025-03-16 02:26:08,345 - root - DEBUG - 收到 0 个标签消息
2025-03-16 02:26:08,345 - root - DEBUG - 输出目录中有 18 个图像文件
2025-03-16 02:26:08,345 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\0.jpg
2025-03-16 02:26:08,345 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,345 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\1.jpg
2025-03-16 02:26:08,345 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,345 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\10.jpg
2025-03-16 02:26:08,345 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,345 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\11.jpg
2025-03-16 02:26:08,346 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,346 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\12.jpg
2025-03-16 02:26:08,346 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,346 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\13.jpg
2025-03-16 02:26:08,346 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,346 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\14.jpg
2025-03-16 02:26:08,346 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,346 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\15.jpg
2025-03-16 02:26:08,346 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,346 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\16.jpg
2025-03-16 02:26:08,346 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,346 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\2.jpg
2025-03-16 02:26:08,346 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,346 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\3.jpg
2025-03-16 02:26:08,346 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,346 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\4.jpg
2025-03-16 02:26:08,346 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,346 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\5.jpg
2025-03-16 02:26:08,346 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,346 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\6.jpg
2025-03-16 02:26:08,347 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,347 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\7.jpg
2025-03-16 02:26:08,347 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,347 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\8.jpg
2025-03-16 02:26:08,347 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,347 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\9.jpg
2025-03-16 02:26:08,347 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,347 - root - DEBUG - 处理图像文件: D:/workspace/LabelQuick/video\image1.jpg
2025-03-16 02:26:08,347 - root - DEBUG - 找到 0 个匹配的标签消息
2025-03-16 02:26:08,347 - root - INFO - 检测打标过程全部完成
